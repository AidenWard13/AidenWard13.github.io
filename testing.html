<html>


<head>

<link rel="stylesheet" href="mouseEffect.css">

<style>
body{background-color:orange;}
</style>

<script>

function setStyleRule(selector,rule){
	stylesheet = document.styleSheets[document.styleSheets.length-1];

	for(i in document.styleSheets){
		if(document.styleSheets[i].href && document.styleSheets[i].href.indexOf("mouseEffect.css")){
			stylesheet = document.styleSheets[i];
			break;
		}
	}

	if(stylesheet.addRule){stylesheet.addRule(selector,rule)}
	else if(stylesheet.insertRule){stylesheet.insertRule(selector + ' { ' + rule + ' }', stylesheet.cssRules.length)}
}

//setStyleRule(".particle","background:red;")

style = document.createElement("style")
document.head.appendChild(style);
style.innerHTML = "body{background-color:green;}";
style.innerHTML += ".particle{background:purple;}";

//alert("z "+document.styleSheets[-1])
//alert("a "+document.styleSheets[0])
//alert("b "+document.styleSheets[1])
//alert("c "+document.styleSheets[2])
//alert("d "+document.styleSheets[3])

stylesheet = document.styleSheets[document.styleSheets.length-1];
alert("amout = "+document.styleSheets.length)
for(s=document.styleSheets.length-1; s>=0; s--){ // go through sheets
	styleSheet=document.styleSheets[s]
	//alert(s+" cont="+styleSheet)
	alert(s+" : "+styleSheet.cssRules)
//	styleSheet=document.styleSheets[s]
	//alert(styleSheet.attributes)
	for(r=0; r<styleSheet.cssRules.length; r++){ // go through rules
		cssRule=styleSheet.cssRules[r]
		alert(cssRule.selectorText)
		//if(cssRule.selectorText==ruleName)return cssRule // found rule
	}
}

//for(i in document.styleSheets){
//	if(document.styleSheets[i].href && document.styleSheets[i].href.indexOf("mouseEffect.css")){
//		stylesheet = document.styleSheets[i];
//		break;
//	}
//}


function rand(a,b){return Math.round(Math.random()*(b-a))+a} // random int a-b inclusive

// turn string into actual element (Document Object Model)
function createDOM(s){e=document.createElement("div");e.innerHTML=s;return e.firstChild}

r=6 // particle spawn range
mx=-1; my=-1 // hold onto mouse position
prev={x:mx,y:my} // detect inactive mouse
t=0 // inactive time

window.addEventListener("mousemove",function(e){mx=e.pageX,my=e.pageY},false)
window.addEventListener("mouseout",function(e){t=150,prev.x=mx,prev.y=my},false)

window.onload=function(){ // wait for html to load (so we can get the elements)
	mouseEffect=document.getElementById("mouseEffect") // element that holds particles
	mouseEffect.addEventListener("animationend",function(e){p=e.srcElement;p.remove()},false) // remove after animation

	setInterval(function(){
		if(mx==prev.x && my==prev.y){t+=1} // count how long still
		else{prev.x=mx,prev.y=my,t=0} // update pos, reset count
		if(t<150)mouseEffect.appendChild(createDOM("<div class='particle' style='left:"+rand(mx-r,mx+r)+"px;top:"+rand(my-r,my+r)+"px;'></div>"))
	},1) // 1 tick delay
}
</script>

</head>


<body>
<div id="mouseEffect"></div>
</body>


</html>



